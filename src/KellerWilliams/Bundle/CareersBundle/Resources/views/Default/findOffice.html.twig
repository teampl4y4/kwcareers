{% extends '::base.html.twig' %}
{% block body %}


        <!-- .container_12 start -->
        <div class="container_12">

            <article class="grid_12">
                <div id="kw_mc_map" style="width:100%; height: 400px">Loading Map...</div>
                {% if marketCenter is not null %}
                    <h1>{{ marketCenter.name }}</h1>
                {% endif %}
            </article>

        </div>


{% endblock %}

{% block javascripts %}

    <script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyCtXKyFUqbWptlG7iFlRXcG8X8pWxRSqWg"></script>

    <script type="text/javascript">
        $(document).ready(function() {

            $.getScript( '{{ asset('bundles/kellerwilliamscareers/js/gmaps.js') }}', function() {

                var mapOptions = {
                    div: '#kw_mc_map',
                    lat: 39.50,
                    lng: -98.35,
                    zoom: 4,
                    styles: [
                        {
                            "featureType": "water",
                            "elementType": "geometry",
                            "stylers": [{"color": "#e9e9e9"}, {"lightness": 17}]
                        }, {
                            "featureType": "landscape",
                            "elementType": "geometry",
                            "stylers": [{"color": "#f5f5f5"}, {"lightness": 20}]
                        }, {
                            "featureType": "road.highway",
                            "elementType": "geometry.fill",
                            "stylers": [{"color": "#ffffff"}, {"lightness": 17}]
                        }, {
                            "featureType": "road.highway",
                            "elementType": "geometry.stroke",
                            "stylers": [{"color": "#ffffff"}, {"lightness": 29}, {"weight": 0.2}]
                        }, {
                            "featureType": "road.arterial",
                            "elementType": "geometry",
                            "stylers": [{"color": "#ffffff"}, {"lightness": 18}]
                        }, {
                            "featureType": "road.local",
                            "elementType": "geometry",
                            "stylers": [{"color": "#ffffff"}, {"lightness": 16}]
                        }, {
                            "featureType": "poi",
                            "elementType": "geometry",
                            "stylers": [{"color": "#f5f5f5"}, {"lightness": 21}]
                        }, {
                            "featureType": "poi.park",
                            "elementType": "geometry",
                            "stylers": [{"color": "#dedede"}, {"lightness": 21}]
                        }, {
                            "elementType": "labels.text.stroke",
                            "stylers": [{"visibility": "on"}, {"color": "#ffffff"}, {"lightness": 16}]
                        }, {
                            "elementType": "labels.text.fill",
                            "stylers": [{"saturation": 36}, {"color": "#333333"}, {"lightness": 40}]
                        }, {"elementType": "labels.icon", "stylers": [{"visibility": "off"}]}, {
                            "featureType": "transit",
                            "elementType": "geometry",
                            "stylers": [{"color": "#f2f2f2"}, {"lightness": 19}]
                        }, {
                            "featureType": "administrative",
                            "elementType": "geometry.fill",
                            "stylers": [{"color": "#fefefe"}, {"lightness": 20}]
                        }, {
                            "featureType": "administrative",
                            "elementType": "geometry.stroke",
                            "stylers": [{"color": "#fefefe"}, {"lightness": 17}, {"weight": 1.2}]
                        }
                    ]
                };

                var map = new GMaps(mapOptions);

                {% if marketCenter is null %}
                    GMaps.geolocate({
                        success: function(position) {
                            map.setCenter(position.coords.latitude, position.coords.longitude);
                            map.setZoom(15);
                        }
                    });
                {% else %}
                    map.addMarker({
                        lat: {{ marketCenter.lat }},
                        lng: {{ marketCenter.lng }},
                        title: '{{ marketCenter.name }}',
                        url: 'market-center/{{ marketCenter.uid }}',
                        click: function(e)
                        {
                            window.location.href = e.url;
                        }
                    });
                    map.setCenter({{ marketCenter.lat }}, {{ marketCenter.lng }});
                    map.setZoom(11);

                {% endif %}

            });


        });
    </script>

{% endblock %}
